# TIL Tracker App - Tasks

*Self-note: Remember to use `rbenv exec` before rails/bundle/rake commands if the shell environment is still inconsistent. However, `bin/dev` might work directly (`./bin/dev`) if `rbenv exec bin/dev` fails.*

**Convention:** Learning logs (`LEARNINGS.md`, `db/seeds.rb`) should be written in the first person.

## ðŸš€ Phase 1: Initial Setup & Core Structure (Date: [Current Date])

- [x] Create Rails project (`rails new til_tracker ...`) - Completed [Current Date]
- [x] Fix `pg` gem installation issues (`brew install libpq`, `bundle config`, `rbenv exec bundle install`) - Completed [Current Date]
- [x] Create `PLANNING.md` with project overview, stack, conventions, decisions - Completed [Current Date]
- [x] Create `TASK.md` (this file) - Completed [Current Date]
- [x] Add `rspec-rails` to `Gemfile` and install - Completed Apr 8, 2025 (Already present, ran install)
- [x] Run `rbenv exec rails generate rspec:install` - Completed Apr 8, 2025
- [x] Generate `Learning` model (`title:string`, `body:text`, `tags:string`) using `rbenv exec` - Completed Apr 8, 2025 (Changed from Til)
- [x] Generate `StaticPagesController` (`home`, `hire_me`, `about`) using `rbenv exec` - Completed Apr 8, 2025 (Controller already existed)
- [x] Generate `LearningsController` (`index`, `new`, `create`) using `rbenv exec` - Completed Apr 8, 2025 (Changed from TilsController)
- [x] Define routes in `config/routes.rb` for all pages - Completed Apr 8, 2025 (Updated for Learnings)
- [x] Create initial view files (`.html.erb`) for all actions/pages - Completed Apr 8, 2025 (Generated by commands)
- [x] Create database (`rbenv exec rails db:create`) - Completed Apr 8, 2025 (Already existed)
- [x] Run migrations (`rbenv exec rails db:migrate`) - Completed Apr 8, 2025
- [x] Add all generated files to Git and make initial commit - Completed Apr 8, 2025
- [x] Add basic navigation header to `application.html.erb` - Completed Apr 9, 2025
- [x] Update placeholder views for static and learning pages - Completed Apr 9, 2025

## ðŸ”¬ Phase 2: Feature Implementation

- [x] Implement Home page (`static_pages#home`) content. - Completed Apr 8, 2025 -> Removed [Current Date]
- [x] Implement Hire Me page (`static_pages#hire_me`) content. - Completed Apr 8, 2025 (Placeholder)
- [x] Implement About page (`static_pages#about`) content (Optional). - Completed Apr 9, 2025 -> Updated Apr 20, 2024 (Detailed content added)
- [x] Implement Learnings list page (`learnings#index`). - Completed Apr 9, 2025
    - [x] Display all Learnings (title, body, tags, created_at). - Completed Apr 9, 2025
    - [x] Sort by newest first. - Completed Apr 9, 2025
    - [x] Link to create new Learning. - Completed Apr 9, 2025
- [x] Implement New Learning form (`learnings#new`). - Completed Apr 9, 2025
    - [x] Build the form using `form_with`. - Completed Apr 9, 2025
- [x] Implement Learning creation (`learnings#create`). - Completed Apr 9, 2025
    - [x] Use strong parameters. - Completed Apr 9, 2025
    - [x] Add basic model validations (presence of title, body). - Completed Apr 9, 2025
    - [x] Redirect to `learnings#index` on success. - Completed Apr 9, 2025
    - [x] Re-render `learnings#new` on validation failure. - Completed Apr 9, 2025
- [x] Implement multi-delete functionality for Learnings. - Completed Apr 9, 2025
    - [x] Add checkboxes and delete form to `learnings#index`. - Completed Apr 9, 2025
    - [x] Add `destroy_multiple` route. - Completed Apr 9, 2025
    - [x] Add `destroy_multiple` controller action. - Completed Apr 9, 2025
- [x] Remove TailwindCSS gem and configuration. - Completed Apr 10, 2025
    - [x] Remove Tailwind build process from `bin/dev`.
    - [x] Replace `tailwind_stylesheet_pack_tag` with `stylesheet_link_tag` in layout.
    - [x] Remove Tailwind classes from views (`.html.erb` files).
    - [x] Create `app/assets/stylesheets/application.css`.
    - [x] Add basic HTML element styling (body, h1, p, links) to `application.css`.
    - [x] Add minimal, semantic base styles for typography, forms, buttons, layout.
- [x] Implement retroactive logging: - Completed Apr 13, 2024
    - [x] Add `learned_on` date field to `Learning` model.
    - [x] Add `learned_on` date input to the form.
    - [x] Update index view to display `learned_on` and sort by it.

## ðŸ”¬ Phase 3: Testing

- [ ] Write model spec for `Learning` (validations).
    - [ ] Verify valid learning instance passes validation.
    - [ ] Verify learning instance is invalid without a title.
    - [ ] Verify learning instance is invalid without a body.
    - [ ] (Optional) Verify `tag_list` helper method works correctly.
- [ ] Write request spec for `StaticPagesController` (ensure pages load).
- [ ] Write request spec for `LearningsController` (index, new, create actions).
    - [ ] Test successful Learning creation.
    - [ ] Test validation failure on Learning creation.
- [ ] Write basic feature spec for creating a Learning (Optional).

## ðŸ§¼ Phase 4: Refinement & Documentation

- [x] Refine UI/UX based on 37signals' approach to CSS, UI, and UX. - Completed Apr 12, 2025 -> Updated Apr 19, 2024
  - [x] Improved learning item display with selectable boxes instead of checkboxes.
  - [x] Fixed alignment issues between selection indicator and learning titles.
  - [x] Enhanced visual feedback on selection with subtle color changes.
  - [x] Refined "Log New Learning" / "Edit Learning" form UI/UX: - Completed Apr 19, 2024
    - Added placeholders and helper text for guidance.
    - Improved spacing and visual grouping using CSS and `.form-group` divs.
    - Ensured consistent fonts between inputs and textareas (`font-family: inherit`).
    - Fixed left alignment to match index page by adjusting container padding.
    - Clarified date format in label (`Learned on (YYYY-MM-DD)`).
    - Decided against `date_select` or custom date picker, sticking with native `date_field`.
    - Resolved asset pipeline issues preventing CSS updates from appearing (involved checking cache, clobbering assets, verifying HTML/CSS edits).
- [x] Remove `static_pages#home` action, view, tests and set `learnings#index` as root path. - Completed Apr 19, 2024
- [x] Clean up project files and dependencies. - Completed Apr 13, 2024
    - [x] Removed unused Rails directories (`app/jobs`, `app/mailers`, `app/helpers`, `app/controllers/concerns`, `vendor`, `script`, `storage`).
    - [x] Removed unused configuration files (`.kamal`, `.github`, `Dockerfile`, `.dockerignore`, `.rubocop.yml`, default icons).
    - [x] Removed unused gems (`jbuilder`, `solid_queue`, `solid_cable`, `kamal`, `rubocop-rails-omakase`).
    - [x] Ran `bundle install` to update `Gemfile.lock`.
    - [x] Removed unused spec files (`spec/helpers`).
- [x] Implement Tag Filtering: - Completed Apr 14, 2024
    - [x] Add `tag_list` helper method to `Learning` model.
    - [x] Update `LearningsController#index` to filter by `params[:tag]` and pass unique tags to view.
    - [x] Update `learnings/index.html.erb` to wrap list in Turbo Frame.
    - [x] Update `learnings/index.html.erb` to display clickable tag links that filter the list.
    - [x] Add basic CSS for tag styling.
    - [x] Add request specs for tag filtering functionality.
        - Note: Required adding `factory_bot_rails` gem for test data generation.
        - Note: Required adding `rails-controller-testing` gem for `render_template` matcher.
        - Note: Fixed existing static page specs to use path helpers (`root_path`, etc.).
- [x] Move "Delete Selected" button to top left next to "Log New Learning". (Added Apr 19, 2024)
   *Note: Attempt to dynamically enable/disable based on selection reverted due to JS issues.*
- [x] Create "Writing Samples" static page:
  - [x] Add route (`/writing-samples`).
  - [x] Add controller action (`StaticPagesController#writing_samples`).
  - [x] Create view (`writing_samples.html.erb`).
  - [x] Populate view with content from `.cursor/rules/37signals.md`.
  - [x] Add link to navigation.
  - [x] Add request spec.
- [ ] Write `README.md` (summary, screenshots, reflection, setup).
- [ ] Update `PLANNING.md` and `TASK.md` with final decisions/status.

## ðŸš€ Phase 5: Deployment

- [x] Choose deployment provider (Fly.io or Render). (Added Apr 19, 2025)
- [x] Configure for deployment. (Added Apr 19, 2025)
- [x] Deploy the application. (Added Apr 19, 2025)
- [x] Verify deployed application works. (Added Apr 19, 2025)
- [x] Add live URL to `README.md`. (Added Apr 19, 2025)
- **UI Enhancement:** Moved "Delete Selected" button to top left. (Attempt to conditionally disable reverted). (Added Apr 19, 2024)
- - **TODO:** Revisit adding `data-turbo-confirm` to the "Delete Selected" button. (Currently non-functional, potentially due to Turbo JS issues). (Added Apr 19, 2024)

## ðŸš€ Phase 7: Final Application Polish (Added Apr 21, 2024)

- [x] Update `hire_me.html.erb` with content adapted from cover letter. (Completed Apr 21, 2024)
- [x] Add links to downloadable CV and Cover Letter PDFs on `hire_me.html.erb`. (Completed Apr 21, 2024)
  - *Note:* Requires me to manually create `til_tracker/public/documents/` directory and place renamed `cv.pdf` and `cover_letter.pdf` files there.
- [x] Reorder navigation links in `application.html.erb` to: Learnings > New Learning > About The App > Hire Me > Writing Samples. (Completed Apr 21, 2024)
  - *Note:* I fixed the PDF title metadata externally using Nitro PDF Pro. (Added Apr 22, 2024)
- [x] Enabled static file serving in `development.rb` to fix local PDF access. (Completed Apr 22, 2024)
- [x] Updated `hire_me.html.erb` content again to refine narrative (Honesty vs Potential). (Completed Apr 22, 2024)
- [x] Used `mail_to` helper for email link. (Completed Apr 22, 2024)

## ðŸ§¬ Phase 6: Production Data Seeding (Added Apr 20, 2024)

- [x] Define strategy: Use `.cursor/rules/LEARNINGS.md` as source, parse into `db/seeds.rb` format. (Completed Apr 20, 2024)
- [x] Read and parse `.cursor/rules/LEARNINGS.md`. (Completed Apr 20, 2024)
- [x] Transform parsed data into `Learning` attributes (title, body, tags, learned_on). (Completed Apr 20, 2024)
- [x] Generate Ruby code for `db/seeds.rb` using `Learning.find_or_create_by!`. (Completed Apr 20, 2024)
- [x] Update `til_tracker/db/seeds.rb` with generated code. (Completed Apr 20, 2024)
- [x] Update `PLANNING.md` with decision. (Completed Apr 20, 2024)
- [x] Update `TASK.md` with these steps. (Completed Apr 20, 2024)
- [x] Deploy seed data to production (Render): (Completed Apr 23, 2024)
    - [x] Commit and push the updated `db/seeds.rb`.
    - [x] Modify Render Build Command: Add `bundle exec rails db:seed` after asset compilation. -> Changed to Pre-Deploy Command
    - [x] Trigger Render deployment.
    - [x] Verify data appears correctly in the live application. -> Required `db:seed:replant` workaround
    - [x] Modify Render Pre-Deploy Command: Remove `db:seed:replant`, revert to `db:migrate; db:seed` (or similar idempotent setup).
    - [x] (Optional) Commit and push build command cleanup. -> Not needed as changes were in Render UI.

## ðŸ”§ Future Enhancements / Technical Debt

- [ ] Revisit adding `data-turbo-confirm` to the "Delete Selected" button (currently non-functional, potentially due to Turbo JS issues). (Added Apr 19, 2024)

## ðŸ’¡ Discovered During Work
*(Add any new tasks, questions, or blockers that arise here)*
- Shell environment inconsistencies require using `rbenv exec` before Rails/Bundler commands for reliability. Added note to `TASK.md` and command list in `PLANNING.md`.
- Rails generator failed for model name `Til` due to potential conflict. Switched to `Learning` model and `LearningsController`. Need to clean up leftover `Til` files. (Added Apr 8, 2025)
- Add task: Clean up generated files related to `Til` model/controller. (Added Apr 8, 2025)
- **Decision:** Removed TailwindCSS per new project rules (Apr 9, 2025). Will use hand-crafted CSS. Added related tasks.
- Bundler version issues required installing a specific version (`gem install bundler:2.6.7`) due to shell environment/rbenv activation problems. (Added Apr 13, 2024)
- The `rbenv exec bin/dev` command failed (`command not found`), similar to a previous issue. Running `bin/dev` or `./bin/dev` directly might be necessary if shell PATH/shims are correctly set up. Needs verification/documentation. (Added Apr 13, 2024)
- **Issue (CI):** Rubocop failed because gem was not in bundle. (Added Apr 14, 2024)
  - [x] Added `rubocop-rails-omakase` to `Gemfile` group `:development, :test`. (Completed Apr 14, 2024)
  - Note: Requires running `bundle install` locally before commit.
- **Issue (CI):** Importmap audit failed due to incorrect command (`Unrecognized command "importmap:audit"`, `Don't know how to build task`). (Added Apr 14, 2024)
  - [x] Verified task `importmap:audit` does not exist in local setup via `rake -T`. (Completed Apr 14, 2024)
  - [x] Removed the `scan_js` job entirely from `.github/workflows/ci.yml` as the task is unavailable/non-standard in this setup. (Completed Apr 14, 2024)
- **Issue (CI):** Rubocop linting errors reported (whitespace, empty lines). (Added Apr 14, 2024)
  - **Recommendation:** Run `rbenv exec bundle exec rubocop -A` locally before committing to auto-fix style issues.
- Added `factory_bot_rails` gem to simplify test data creation in specs. (Added Apr 14, 2024)
- Added `rails-controller-testing` gem to fix `assert_template`/`render_template` failures in request specs. (Added Apr 14, 2024)
- Fixed static page request specs (`spec/requests/static_pages_spec.rb`) to use path helpers instead of hardcoded paths causing 404s. (Added Apr 14, 2024)
- Identified pending model spec: `spec/models/learning_spec.rb`. (Added Apr 14, 2024)
- **Data Migration:** Need to migrate local `Learning` data to deployed Render database. (Added Apr 14, 2024)
  - **Options Considered:** Rails Seeds (`db/seeds.rb`), `pg_dump`/`pg_restore`, CSV Export/Import.
  - **Chosen Approach:** Use Rails Seeds for initial data population due to free tier limitations.
  - **Task:** Populate `db/seeds.rb` with local Learning data.
  - **Task:** Temporarily modify Render Build Command (`...; bundle exec rails db:seed`) to run seeds on deploy.
  - **Task:** After successful seeding, remove `db:seed` from Render Build Command.
- **UI Enhancement:** Moved "Delete Selected" button to top left. (Attempt to conditionally disable reverted). (Added Apr 19, 2024)
- **TODO:** Revisit adding `data-turbo-confirm` to the "Delete Selected" button. (Currently non-functional, potentially due to Turbo JS issues). (Added Apr 19, 2024)
- **Issue (CSS):** CSS changes for the new learning form were not appearing despite multiple attempts (hard refresh, server restart). (Added Apr 19, 2024)
  - **Troubleshooting:** Verified `application.html.erb` layout, `Gemfile` (Propshaft), checked Network tab (saw `200 OK (from memory cache)`), ran `rails assets:clobber`.
  - **Resolution:** Found that previous edits to `_form.html.erb` had not been applied correctly. Re-applying the HTML structure changes fixed the issue. Also, corrected `.form-container` padding to fix alignment and added `font-family: inherit` for inputs/textareas.
- **Decision (Date Picker):** Decided to keep the standard `date_field` helper despite browser inconsistencies in icon placement. Added `(YYYY-MM-DD)` to the label for clarity. Considered `date_select` but opted for the simpler native element. (Added Apr 19, 2024)
- **Decision (PDFs):** Placed CV and Cover Letter PDFs in `public/documents/` for simple download links on the Hire Me page, avoiding complex embedding. Need to create the directory and copy files manually. Enabled static file serving in `development.rb`. Edited PDF metadata externally to fix tab titles. (Updated Apr 22, 2024)
- **Decision (Hire Me Narrative):** Refined content to honestly address limited Rails experience while highlighting rapid learning, transferable skills, and framing the app as proof of potential. (Added Apr 22, 2024)
- **Decision (Email Link):** Used `mail_to` helper on Hire Me page. (Added Apr 22, 2024)
- **Issue (Production Seeding):** Standard `db:seed` in Pre-Deploy command didn't update existing records as expected after seed file changes. Required using `DISABLE_DATABASE_ENVIRONMENT_CHECK=1 bundle exec rails db:seed:replant` in Pre-Deploy temporarily to force a reset. Standard command (`db:migrate; db:seed`) restored afterwards. (Added Apr 23, 2024)
- **Convention:** Learning logs (`LEARNINGS.md`, `db/seeds.rb`) should be written in the first person. (Added Apr 23, 2024)

## ðŸš€ Phase 8: Final Documentation & Wrap-up (Added Apr 22, 2024)

- [x] Update `LEARNINGS.md` with recent session learnings. (Completed Apr 22, 2024)
- [x] Update `seeds.rb` to include new learning entries. (Completed Apr 22, 2024)
- [x] Update `PLANNING.md` with recent decisions. (Completed Apr 22, 2024)
- [x] Update `README.md` with project reflection, features list, screenshot placeholder. (Completed Apr 22, 2024)
- [x] Update `TASK.md` documentation (this task). (Completed Apr 22, 2024)

## Session Summary (Apr 22, 2024)
- Updated Hire Me page content and links (PDFs, mailto).
- Troubleshot and fixed static file serving in development for PDFs.
- Addressed PDF metadata issue causing incorrect browser tab titles.
- Updated all relevant documentation (`PLANNING.md`, `TASK.md`, `LEARNINGS.md`, `README.md`) and `seeds.rb` to reflect recent changes and learnings.

## Session Summary (Apr 23, 2024)
- Troubleshot production database seeding issues on Render.
- Updated seed data using `db:seed:replant` workaround in Pre-Deploy command.
- Reverted Pre-Deploy command to standard idempotent setup (`db:migrate; db:seed`).
- Updated `LEARNINGS.md`, `db/seeds.rb`, `TASK.md`, `PLANNING.md` to reflect seeding issues and establish first-person writing convention for learnings.
